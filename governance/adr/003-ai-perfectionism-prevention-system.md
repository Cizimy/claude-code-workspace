# ADR-003: AI完璧主義防止システムの導入決定

## Status
Accepted

## Date
2025-07-14

## Context

### 問題の背景
Claude Code を用いたAI駆動開発において、以下の「AI完璧主義症候群」が確認された：

1. **AI的完璧主義症候群**: 95%→100%への強迫的改善衝動
2. **プロセス過剰最適化**: メタ化により本来目的から乖離
3. **可能性への過剰反応**: 必要性の閾値判断甘化

### 具体的症状例（2025-07-14実例）
- `enhancement_roadmap.md`: 2027年まで3年先の詳細計画作成
- `improvement_recommendations.md`: 13個の改善項目、多くが推測的
- `implementation_verification_sop.md`: 1225行の過剰詳細化
- **合計削減**: 約1887行 → 約780行（59%削除）

### 既存Hookシステムの制約
現在のTDD × YAGNI × Hooks システムでは以下の制約により対応困難：

#### 技術的限界
1. **反応的制御のみ**: `exit 2` でツール実行停止のみ、根本原因（思考プロセス）は修正されない
2. **Claude Code との双方向通信不可**: Hook は外部プロセスでセッション状態への介入不可
3. **憲法認識の劣化対策なし**: 長時間対話で基本原則を「忘れる」現象への対策不足

## Decision

AI完璧主義症候群防止システムを導入し、以下3つの戦略で対応する：

### 戦略1: 「教育的ブロック」システム
**実装**: `constitution-guard.sh` Hook
- **大量ドキュメント作成検出**: MultiEditで5ファイル以上の同時作成をブロック
- **長期計画文書検出**: 2026年以降の計画、"roadmap"、"enhancement"キーワードを検出
- **過剰詳細化検出**: 500行超の大量ドキュメント作成をブロック
- **教育的指導**: 憲法原則を引用した具体的是正指示を提供

### 戦略2: 憲法リマインダーシステム
**実装**: 既存Hook (`tdd-guard.sh`) への統合
- **定期的憲法確認**: 20ツール実行毎に基本原則をリマインド
- **長時間セッション検出**: ツール実行カウンターによる自動検出
- **CLAUDE.md参照促進**: 意識的な憲法確認を促すメッセージ

### 戦略3: CLAUDE.md強化
**実装**: プロジェクト憲法への新セクション追加
```markdown
## AI完璧主義症候群対策

### ⚠️ 禁止事項
- 95%以上の完璧を追求しない
- 推測実装禁止
- 大量ドキュメント作成禁止（5ファイル以上同時作成不可）
- 長期計画作成禁止（2026年以降の計画作成不可）

### 🔍 自己チェック必須項目
1. 今すぐ使うか？
2. 実証されているか？
3. 最もシンプルか？
4. 本当に必要か？
```

## Consequences

### 期待される正の影響
1. **大量ドキュメント作成の即座阻止**: 不要な文書作成を事前防止
2. **長期計画作成の事前ブロック**: 推測的実装の抑制
3. **憲法原則の定期的想起**: 基本方針の継続的認識維持
4. **開発効率の向上**: 無駄作業削減による本質的作業への集中

### 潜在的な負の影響とリスク軽減策
1. **正当な作業のブロック**: 
   - 軽減策: 設定ファイル・テストファイル・ガバナンス文書を除外対象に設定
   - 緊急時バイパス: `CLAUDE_HOOKS_DISABLED=true` 環境変数での一時無効化

2. **過度な制約による開発阻害**:
   - 軽減策: 段階的導入（警告→エラーの段階的強化）
   - 調整可能な閾値設定（ファイル数、行数の動的調整）

3. **チーム開発での不整合**:
   - 軽減策: プロジェクト固有設定の継承機能
   - 文書化: 明確な運用ガイドラインの提供

## Implementation Plan

### Phase 1: 緊急対策（即座実装）
1. **constitution-guard.sh** 作成・統合
2. **CLAUDE.md** に完璧主義対策セクション追加
3. **.claude/settings.json** にHook統合

### Phase 2: システム強化（1週間後）
1. **憲法リマインダー** を既存Hookに統合
2. **違反パターン学習** 機能追加
3. **統計ログ** 収集・分析開始

### Phase 3: 長期改善（1ヶ月後）
1. **違反履歴分析** による感度調整
2. **新たな違反パターン** 検出ルール追加
3. **システム効果測定** と改善

## Success Metrics

### 定量指標
- **違反検出率**: 95%以上の憲法違反を事前検出
- **ドキュメント削減**: 不要ドキュメント作成50%削減
- **リマインダー効果**: 長時間セッションでの方針逸脱30%削減

### 定性指標
- **開発フォーカス向上**: 本質的なタスクへの集中
- **YAGNI原則定着**: 推測実装の自然な回避
- **シンプル設計維持**: 複雑性増大の抑制

## Related Documents
- [ADR-000: Claude Code採用決定](000-claude-code-adoption.md)
- [ADR-002: 継続改善システム](002-continuous-improvement-system.md)
- [複雑性制御アーキテクチャ](../../.claude/tmp/complexity_control_architecture.md)
- [AI完璧主義防止計画草案](../../.claude/tmp/ai_perfectionism_prevention_plan_draft.md)

## Review
- **レビュー予定日**: 2025-08-14
- **成功指標評価**: 月次でKPI測定・効果確認
- **システム調整**: 違反パターン学習による継続的改善

---

*このADRは、AI駆動開発における品質ガードシステムの継続改善を目的として作成されました。技術的制約を踏まえつつ、実現可能な範囲での最大効果を狙います。*